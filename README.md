# 高機能アンケートシステム

PHP、CSS、JavaScriptで作成された本格的なWebアンケートシステムです。条件分岐機能、複数質問タイプ、URLパラメータ統合、回答分析機能を持つ高機能なWebアプリケーションです。

## 主な機能

### 📝 アンケート作成・管理
- **直感的なUI**: ドラッグ&ドロップで質問を追加
- **8種類の質問タイプ**: テキスト、メール、ラジオボタン、チェックボックス、ドロップダウン、ラベル、パラメータ
- **条件分岐機能**: 回答に応じた動的質問表示
- **質問順序変更**: ドラッグ&ドロップによる並び替え
- **必須回答設定**: 質問単位での必須設定
- **リアルタイムプレビュー**: 作成中の確認機能

### 🌐 アンケート配布・回答
- **公開/非公開切り替え**: ワンクリックでの状態変更
- **URLコピー機能**: 回答ページへの直接リンク
- **QRコード生成**: モバイル回答用
- **レスポンシブデザイン**: 全デバイス対応
- **URLパラメータ統合**: 外部システムからのデータ自動取得
- **条件分岐による動的表示**: 回答に応じたリアルタイム質問制御

### 📊 回答分析・管理
- **統計ダッシュボード**: 回答数、完答率、最新回答日時
- **質問別分析**: 円グラフ・棒グラフによる統計表示
- **個別回答詳細**: 回答者単位での詳細表示
- **検索・フィルター**: 日付範囲、キーワード検索
- **CSVエクスポート**: Excel等での分析用データ出力
- **回答削除**: 個別・一括削除機能

## システム要件

- PHP 7.0以上
- Webサーバー（Apache、Nginx等）
- モダンなWebブラウザ（Chrome、Firefox、Safari、Edge）

## セットアップ

### 1. プロジェクトのダウンロード

```bash
git clone <repository-url>
cd questionnaire
```

### 2. 権限設定

```bash
chmod 755 data/
chmod 644 data/*.json
```

### 3. サーバー起動

```bash
# PHPの内蔵サーバーを使用する場合
php -S localhost:8000
```

### 4. アクセス

ブラウザで以下のURLにアクセス：

- **管理画面**: http://localhost:8000/
- **アンケート作成**: http://localhost:8000/create.html
- **回答ページ**: http://localhost:8000/survey.html?id=[アンケートID]
- **回答分析**: http://localhost:8000/responses.html?id=[アンケートID]

## プロジェクト構造

```
/
├── index.html              # 管理画面（初期画面）
├── create.html             # アンケート作成・編集画面
├── survey.html             # 公開アンケート回答ページ
├── responses.html          # 回答閲覧・分析ページ
├── api/                    # PHP API
│   ├── config.php          # 共通設定・関数
│   ├── surveys.php         # アンケートCRUD API
│   └── responses.php       # 回答保存・取得API
├── css/
│   └── style.css           # 共通スタイルシート
├── js/
│   ├── api.js              # API通信ライブラリ
│   ├── script.js           # アンケート作成・編集用
│   ├── manage.js           # 管理画面用
│   └── responses.js        # 回答閲覧用
└── data/
    ├── surveys.json        # アンケートデータ
    └── responses.json      # 回答データ
```

## 使用方法

### アンケートの作成

1. 管理画面にアクセス
2. 「新しいアンケートを作成」ボタンをクリック
3. 質問パネルから質問タイプをドラッグ&ドロップ
4. 質問内容と選択肢を編集
5. 必要に応じて条件分岐を設定
6. プレビューで確認後、保存・公開

### 条件分岐の設定

```javascript
// 例：質問1で「はい」を選択した場合にのみ質問3を表示
{
  "targetQuestionId": 1,
  "operator": "equals",
  "value": "はい"
}
```

### URLパラメータの活用

```
survey.html?id=123&source=email&campaign=summer
```

パラメータタイプの質問で `source` や `campaign` を設定すると、URLパラメータの値が自動的に取得されます。

## API仕様

### アンケートAPI (`/api/surveys.php`)

- `GET`: 全アンケート取得
- `GET ?id=`: 特定アンケート取得  
- `POST`: 新規アンケート作成
- `PUT`: アンケート更新
- `DELETE`: アンケート削除

### 回答API (`/api/responses.php`)

- `POST`: 回答データ保存
- `GET ?surveyId=`: 特定アンケートの回答一覧取得

## サポートする質問タイプ

| タイプ | 説明 | 用途 |
|--------|------|------|
| text | 一行テキスト入力 | 名前、年齢など |
| email | メールアドレス入力 | 連絡先取得 |
| textarea | 複数行テキスト入力 | 意見、感想など |
| radio | 単一選択 | 性別、年代など |
| checkbox | 複数選択 | 興味のある分野など |
| select | プルダウン選択 | 地域、職業など |
| label | 情報表示専用 | 説明文、注意事項など |
| parameter | URLパラメータ自動取得 | 流入元の追跡など |

## トラブルシューティング

### 権限エラーが発生する場合

```bash
chmod 755 data/
chmod 644 data/*.json
```

### データが表示されない場合

1. ブラウザの開発者ツールでNetworkタブを確認
2. JavaScript コンソールエラーを確認
3. APIレスポンスを直接確認

### PHPエラーが発生する場合

- サーバーのエラーログを確認
- PHP バージョンを確認（7.0以上が必要）

## ライセンス

このプロジェクトはMITライセンスの下で公開されています。

## 貢献

バグ報告や機能提案は、Issuesでお知らせください。プルリクエストも歓迎します。

## 技術スタック

- **バックエンド**: PHP
- **フロントエンド**: HTML5, CSS3, JavaScript (jQuery)
- **データ保存**: JSON ファイル
- **チャート**: Chart.js
- **通知**: toastr
- **UI**: Bootstrap + カスタムCSS